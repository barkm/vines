var tt=Object.defineProperty;var it=(e,t,o)=>t in e?tt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o;var B=(e,t,o)=>(it(e,typeof t!="symbol"?t+"":t,o),o),G=(e,t,o)=>{if(!t.has(e))throw TypeError("Cannot "+o)};var i=(e,t,o)=>(G(e,t,"read from private field"),o?o.call(e):t.get(e)),r=(e,t,o)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,o)},h=(e,t,o,s)=>(G(e,t,"write to private field"),s?s.call(e,o):t.set(e,o),o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const l of c.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function s(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}})();const J=(e,t)=>[e[0]!==t[0],e[1]!==t[1]],et=(e,t)=>[e[0]===t[0],e[1]===t[1]];var f,g,m,d,q;const C=class{constructor(t,o,s,n){r(this,f,void 0);r(this,g,void 0);r(this,m,void 0);r(this,d,void 0);r(this,q,t=>{const[o,s]=t;return[o<0?i(this,g)+o:o>i(this,g)?o-i(this,g):o,s<0?i(this,m)+s:s>i(this,m)?s-i(this,m):s]});B(this,"plot",t=>{const o=i(this,q).call(this,i(this,f)),s=i(this,q).call(this,t.position);i(this,d).beginPath(),et(J(o,i(this,f)),J(s,t.position)).every(Boolean)&&(i(this,d).moveTo(...o),i(this,d).lineTo(...s),i(this,d).strokeStyle=t.color,i(this,d).lineWidth=2,i(this,d).stroke()),h(this,f,[...t.position])});B(this,"copy",()=>new C(i(this,f),i(this,d),i(this,g),i(this,m)));h(this,f,t),h(this,d,o),h(this,g,s),h(this,m,n)}};let K=C;f=new WeakMap,g=new WeakMap,m=new WeakMap,d=new WeakMap,q=new WeakMap;const a=(e,t)=>(t-e)*Math.random()+e,S=(e,t=1)=>t*Math.tanh(e/t),ot=e=>[...Array(e).keys()],U=(e,t,o)=>ot(o).map(s=>s*(t-e)/o+e),V=e=>[new Q(e,1),new Q(e,-1)];var b,x,E,N,O,W,F,H;class Q{constructor({position:t,direction:o=0,length:s=40,width:n=10,steps:c=20,color:l="black"},y){r(this,b,void 0);r(this,x,void 0);r(this,E,void 0);r(this,N,void 0);r(this,O,void 0);r(this,W,void 0);r(this,F,0);r(this,H,void 0);h(this,b,[...t]),h(this,x,o),h(this,E,s),h(this,N,n),h(this,O,c),h(this,H,y),h(this,W,l)}spawn(){return[]}next(){let t=i(this,F)/i(this,O);const o=t>=1;t=Math.min(t,1);const s=i(this,E)*t,n=i(this,H)*i(this,N)*Math.sin(Math.PI*t),c=Math.cos(i(this,x)),l=Math.sin(i(this,x)),y=[i(this,b)[0]+s*c-n*l,i(this,b)[1]+s*l+n*c];return h(this,F,i(this,F)+1),{value:{position:y,color:i(this,W)},done:o}}}b=new WeakMap,x=new WeakMap,E=new WeakMap,N=new WeakMap,O=new WeakMap,W=new WeakMap,F=new WeakMap,H=new WeakMap;const st=(e,{position:t,direction:o=0,length:s=40,width:n=10,steps:c=40,color:l="black"})=>U(0,2*Math.PI,e).flatMap(y=>V({position:t,direction:o+a(.98,1.02)*y,length:a(.9,1.1)*s,width:n,steps:c,color:l}));var p,u,P,v,k,I,_,L,R;const D=class{constructor({position:t,direction:o=0,step_length:s=10,direction_delta:n=Math.PI/5,stop_prob:c=.0075,branch_prob:l=.01,leaf_prob:y=.1,flower_prob:$=.0075}){r(this,p,void 0);r(this,u,void 0);r(this,P,void 0);r(this,v,void 0);r(this,k,void 0);r(this,I,void 0);r(this,_,void 0);r(this,L,void 0);r(this,R,!1);h(this,p,t),h(this,u,o),h(this,P,s),h(this,v,n),h(this,k,c),h(this,I,l),h(this,_,y),h(this,L,$)}next(){return i(this,R)||(h(this,u,i(this,u)+a(-1,1)*i(this,v)),i(this,p)[0]+=i(this,P)*Math.cos(i(this,u)),i(this,p)[1]+=i(this,P)*Math.sin(i(this,u)),h(this,R,a(0,1)<i(this,k))),{value:{position:[...i(this,p)],color:"black"},done:i(this,R)}}spawn(){if(a(0,1)<i(this,_)){const t=a(30,40),o=t/4;return V({position:[...i(this,p)],direction:i(this,u)+a(-1,1)*Math.PI/3,length:t,width:o})}if(a(0,1)<i(this,L)){const t=a(40,50),o=t/4;return st(10,{position:[...i(this,p)],direction:i(this,u)+a(-1,1)*Math.PI/3,length:t,width:o})}return a(0,1)<i(this,I)?[new D({position:[...i(this,p)],direction:i(this,u),direction_delta:S(i(this,v),Math.PI/2),stop_prob:S(3*i(this,k)),branch_prob:S(i(this,I)),leaf_prob:S(i(this,_)),flower_prob:S(i(this,L))})]:[]}};let j=D;p=new WeakMap,u=new WeakMap,P=new WeakMap,v=new WeakMap,k=new WeakMap,I=new WeakMap,_=new WeakMap,L=new WeakMap,R=new WeakMap;let w=document.getElementById("canvas");w.width=window.devicePixelRatio*window.innerWidth;w.height=window.devicePixelRatio*window.innerHeight;w.style.width=window.innerWidth.toString()+"px";w.style.height=window.innerHeight.toString()+"px";let A=w.getContext("2d"),nt=e=>e.filter(t=>{const o=t.head.next();return t.plotter.plot(o.value),!o.done}).flatMap(t=>[t,...t.head.spawn().map(o=>({head:o,plotter:t.plotter.copy()}))]),M=[];const z=e=>U(0,2*Math.PI,10).map(t=>({head:new j({position:[...e],direction:t}),plotter:new K([...e],A,w.width,w.height)})),X=window.devicePixelRatio*window.innerWidth,Y=window.devicePixelRatio*window.innerHeight;M=z([X/2,Y/2]);w.addEventListener("click",e=>{const t=[window.devicePixelRatio*e.x,window.devicePixelRatio*e.y];M.push(...z(t))});let T=0;const Z=()=>{A.globalAlpha=.5,M=nt(M),M.length?T=0:T++,T>60&&(A.globalAlpha=.1,A.fillStyle="white",A.fillRect(0,0,w.width,w.height)),T>100&&M.push(...z([Math.random()*X,Math.random()*Y])),requestAnimationFrame(Z)};Z();
